# Observer Pattern

어떤 것을 관찰하고 상태 변화에 따라 반응하여야 할 때 사용 한다.

발행(publish) - 구독(subscribe) 패턴을 구현 할 수 있다.

# 장점

- 상태를 변경하는 객체(publisher)와 변경을 감지하는 객체(subscriber)의 관계를 느슨하게 유지 할 수 있다.
- subject 의 상태 변경을 주기적으로 조회하지 않고 자동으로 감지할 수 있다.
- 런타임에 옵저버를 추가하거나 제거할 수 있다

# 단점

- 복잡도가 증가한다.
- 다수의 observer 객체를 등록 이후 해지 않는다면 memory leak 발생할 수 있다.

## 관측 데이터 복제(Duplicate Observed Data)

GUI 프로그램을 제작 시 GUI 관련 부분과 GUI와 관련 없는 부분이 뒤섞일 때가 존재

- GUI 관련 부분: 사용자가 보는 부분
- GUI와 관련이 없는 부분: 도메인이나 비즈니스 로직 또는 모델 등(e.g. 급여 계산, 통화 환산, 데이터 검색, 암호 처리 등)

GUI와 관련이 있는 부분과 그렇지 않은 부분이 모두 한 클래스에 섞여 있으면 수정이 어려워짐

모델과 뷰가 혼재하면 리팩토링이 필요함. 
이를 관측 데이터 복제(Duplicate Observed Data) 리팩토링 이라함

이 리팩토링은 혼재하는 모델과 뷰를 분리함.
관찰자 패턴이나 이벤트 리스너를 사용해서 모델 내용이 변하면 그 사실을 뷰에 알리고 모델과 뷰를 동기화함

'복제'라는 의미는 모델이 데이터를 가지지만 뷰도 어떤 형태로든 데이터를 가짐. 
숫자를 표시하든 그래프로 표시하든 모델 내용을 어떤 형태로든 반영한 데이터가 뷰 내부에 존재하기 마련임

관측 데이터 복제라는 용어는 '뷰는 모델의 데이터를 복사한 형태로 가지고, 관찰자 패턴이나 이벤트 리스너로 두 데이터를 동기화한다는 의미'

### 방법

1. 모델을 나타내는 클래스 작성
   1. 모델을 나타내는 클래스 작성 - 클래스 추출
   2. 뷰: 뷰에서 모델 참조
   3. 뷰: 모델을 메서드로 조작
   4. 컴파일 테스트
2. 통지 관련 클래스와 인터페이스 작성
   1. 통지 내용을 나타내는 인터페이스 선언
   2. 통지 관련 인터페이스 선언
   3. 통지를 받는 메서드를 뷰에 선언
   4. 컴파일해서 테스트
3. 뷰 등록과 뷰 통지
   1. 모델: 뷰를 모델에 등록 가능하게 만듦
   2. 뷰: 뷰를 모델에 등록
   3. 모델: '모델을 변경하면 뷰에 통지'하는 코드 작성
   4. 뷰: 통지를 받는 메서드 안으로 표시 갱신 처리를 이동
   5. 컴파일해서 테스트


